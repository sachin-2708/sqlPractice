# sqlPractice

# NamasteSQL Practice Solutions

This repo contains my SQL solutions from NamasteSQL challenges.  
I am solving problems of various difficulty levels to improve my data querying skills and build a strong portfolio.

## My Goals
- Master advanced SQL queries
- Understand real-world business case studies
- Prepare for SQL interviews

## Progress Tracker

| Problem Name          | Difficulty | Status    | Notes                          |
|-----------------------|------------|-----------|--------------------------------|
| [LinkedIn Top Voice](https://github.com/sachin-2708/sqlPractice/blob/main/medium-3-linkedIn-top-voice-Q3.sql)    | Medium     | Completed | Learned to use DATE_FORMAT, Year and Month functions |
| [Electricity Consumption](https://github.com/sachin-2708/sqlPractice/blob/main/easy-06-electricity-consumption.sql)    | Easy     | Completed | Practised Agg functions SUM and AVG and string function LEFT |
| [Math Champion](https://github.com/sachin-2708/sqlPractice/blob/main/easy-11-math-champion.sql)| Easy     | Completed | Used Subquery to find overall Avg value to use in the main query |
| [Deliveroo Top Customer](https://github.com/sachin-2708/sqlPractice/blob/main/easy-12-deliveroo-top-customer.sql)    | Easy     | Completed | Revised Order By and Limit functions |
| [Employee Salary Levels](https://github.com/sachin-2708/sqlPractice/blob/main/easy-30-employee-salary-levels.sql) | Easy     | Completed | Learned to use CTE, CASE WHEN statements and AVG and GROUP BY functions |
| [Income Tax Returns](https://github.com/sachin-2708/sqlPractice/blob/main/medium-27-income-tax-returns.sql) | Medium     | Completed | Used CTE and CROSS JOIN to identify missed return and Used Case When condition with operators and applied Multiple ON conditions to join the CTE to main table |
| [Software vs Data Analytics Engineers](https://github.com/sachin-2708/sqlPractice/blob/main/medium-29-software-vs-data-analytics-engineers.sql) | Medium     | Completed | Practised SUM and CASE WHEN statements with wildcard |
| [Malware Detection](https://github.com/sachin-2708/sqlPractice/blob/main/hard-28-malware-detection.sql) | Hard     | Completed | Learned ROW_NUMBER, LEAD and COUNT window functions, used it in CTE to query data based on the given conditions |
| [Warikoo 20-6-20](https://github.com/sachin-2708/sqlPractice/blob/main/medium-32-warikoo-20-6-20.sql) | Medium     | Completed | Practised Cross Join and Group Concat function and employed arthimetic logics |
| [Average Order Value](https://github.com/sachin-2708/sqlPractice/blob/main/medium-33-average-order-value.sql) | Medium     | Completed | Used ROW_NUMBER AND MAX() OVER() functions to find difference of min and max avg values |
| [Employee vs Manager](https://github.com/sachin-2708/sqlPractice/blob/main/medium-34-employee-vs-manager.sql) | Medium     | Completed | Practised Self Join which is critical if you only have one table for analysis |
| [Cancellation vs Return](https://github.com/sachin-2708/sqlPractice/blob/main/hard-35-cancellation-vs-return.sql) | Hard     | Completed | CTE & CASE WHEN THEN statement utilised. Understood concept of order returned and no returned, cancelled and not cancelled |
| [GAP Sales](https://github.com/sachin-2708/sqlPractice/blob/main/easy-94-gap-sales.sql) | Easy     | Completed | Practised Group By 2 columns and sum |
| [Walmart Sales Pattern](https://github.com/sachin-2708/sqlPractice/blob/main/hard-39-walmart-sales-pattern.sql) | Hard     | Completed | Used multiple CTEs to come up with the solution; incorporated RANK window function in first CTE and then CASE WHEN, MAX function in the next CTE |
| [Zomato Customer Behavior](https://github.com/sachin-2708/sqlPractice/blob/main/hard-41-zomato-customer-behavior.sql) | Hard     | Completed | Used multiple CTEs, DAYOFWEEK, CASE WHEN and SUM, AVG functions to come up with solution |
| [Electronics Items Sale](https://github.com/sachin-2708/sqlPractice/blob/main/easy-95-electronics-items-sale.sql) | Easy     | Completed | Practiced multiple conditions in Having clause after using AVG aggregation |
| [AirBnB Business](https://github.com/sachin-2708/sqlPractice/blob/main/medium-36-airbnb-business.sql) | Medium     | Completed | Used 3 CTEs and RANK windows function to come up with the AVG occupancy rate of rooms |
| [Domain Names](https://github.com/sachin-2708/sqlPractice/blob/main/easy-97-domain-names.sql) | Easy     | Completed | Practised the Substring_Index string function to get the domain name after @ |
| [Subject Average Score](https://github.com/sachin-2708/sqlPractice/blob/main/easy-106-subject-average-score.sql) | Easy     | Completed | Tricky Question -- Required Sub-query, used DISTINCT function and HAVING |
| [Spotify Popular Tracks](https://github.com/sachin-2708/sqlPractice/blob/main/medium-37-spotify-popular-tracks.sql) | Medium     | Completed | Used COUNT DISTINCT in CTE as well as in the Main Query to filter the accurate data and used Limit to get top 2 entries. Alternatively a subquery can also be used. |
| [Uber Driver Ratings](https://github.com/sachin-2708/sqlPractice/blob/main/medium-40-uber-driver-ratings.sql) | Medium     | Completed | Used NTILE() window function to divide the data into a group based on performance parameters |
| [Excess/insufficient Inventory](https://github.com/sachin-2708/sqlPractice/blob/main/medium-44-excess-insufficient-inventory.sql) | Medium     | Completed | Learnt Union function, CHAR function and hard-coding value into a row when you want overall value |
| [Zomato Membership](https://github.com/sachin-2708/sqlPractice/blob/main/medium-45-zomato-membership.sql) | Medium     | Completed | Used a subquery in a CTE and joined multiple CTEs to come at a solution -- With two Alternate Solution, one using CASE WHEN and another using ROW_NUMBER window function |
| [Female Contribution](https://github.com/sachin-2708/sqlPractice/blob/main/medium-48-female-contribution.sql) | Medium     | Completed | Practiced CTE with SUM and CASE WHEN statements |
| [Premium Customers](https://github.com/sachin-2708/sqlPractice/blob/main/medium-4-premium-customers.sql) | Medium     | Completed | Used sub_query in Having clause to filter data; alternatively used CTE and AVG window function to compare values |
| [CIBIL Score](https://github.com/sachin-2708/sqlPractice/blob/main/hard-5-cibil-score.sql) | Hard     | Completed | Used UNION to combine Loan and Credit tables, hard coded values. Used 3 CTEs to arrive at the solution. |
| [Airbnb Top Hosts](https://github.com/sachin-2708/sqlPractice/blob/main/medium-7-airbnb-top-hosts.sql) | Medium   | Completed | Simple solution using Count Distinct and Having condition, alternatively used Count windows function in CTE to filter the data in the main query. |
| [Best Employee Award](https://github.com/sachin-2708/sqlPractice/blob/main/medium-13-best-employee-award.sql) | Medium   | Completed | Used 2 CTEs and understood the logic for ranking from the hint |
| [Business Expansion](https://github.com/sachin-2708/sqlPractice/blob/main/medium-17-business-expansion.sql) | Medium   | Completed | Practised Min function to find the 1st date and then used it as CTE |
| [Hero Products](https://github.com/sachin-2708/sqlPractice/blob/main/medium-18-hero-products.sql) | Medium   | Completed | Used two order by conditions in the row number window function to identify product and category |
| [Account Balance](https://github.com/sachin-2708/sqlPractice/blob/main/medium-24-account-balance.sql) | Medium   | Completed | Union to join same table with transactions credited and debited and then use it in CTE to find the final balance. |
| [Adverse Reactions](https://github.com/sachin-2708/sqlPractice/blob/main/medium-50-adverse-reactions.sql) | Medium   | Completed | Two approaches used, first using CTE to filter data while second was just using left join to multiple on condition |
| [Balanced Team](https://github.com/sachin-2708/sqlPractice/blob/main/medium-51-balanced-team.sql) | Medium   | Completed | Using Sum Windows function, calculated running total and then using that CTE, first identified Seniors and then using Union All Juniors and Seniors were added to it. |
| [Loan Repayment](https://github.com/sachin-2708/sqlPractice/blob/main/medium-52-loan-repayment.sql) | Medium   | Completed | Using Max and Sum in CTE to calculate the repayment amount and last date, joined to the main table. Alternatively, used case when statement in another case when statement for calculations  |
| [Employees Payout](https://github.com/sachin-2708/sqlPractice/blob/main/medium-54-employees-payout.sql) | Medium   | Completed | JOIN, CTE and CASE WHEN statements used to get the solution |
| [Expenses Excluding MasterCard](https://github.com/sachin-2708/sqlPractice/blob/main/medium-56-expenses-excluding-mastercard.sql) | Medium   | Completed | Created two CTEs to seperate the expenses and then joined the two CTEs to find the final result |
| [Order Lead Time](https://github.com/sachin-2708/sqlPractice/blob/main/medium-59-order-lead-time.sql) | Medium   | Completed | Learnt Date_add, datediff functions to calculate revised dates, using them in CTEs to find final solution. Learnt to join table using between dates. Alternate solution is to calculate the days between revised order and ship dates and subtract the holidays between them. |
| [Instagram Marketing Agency](https://github.com/sachin-2708/sqlPractice/blob/main/medium-60-instagram-marketing-agency.sql) | Medium   | Completed | Simple CASE WHEN and AVG funnction used to calculate the output |
| [Fake Ratings](https://github.com/sachin-2708/sqlPractice/blob/main/medium-66-fake-ratings.sql) | Medium   | Completed | Employed AVG Windor funnction to get average in a column to subtract from the main value and then ranked using ROW_NUMBER to get the solution |
| [Food Preparation Time](https://github.com/sachin-2708/sqlPractice/blob/main/medium-67-food-preparation-time.sql) | Medium   | Completed | Learnt the TIMESTAMPDIFF and MINUTE function to calculate the avg food prep time. |
| [Late Food Deliveries](https://github.com/sachin-2708/sqlPractice/blob/main/medium-68-late-food-deliveries.sql) | Medium   | Completed | Tricky Question, had to find order which were delayed due to riders but calculation on time prepared orders. |
| [Country Indicators](https://github.com/sachin-2708/sqlPractice/blob/main/medium-69-country-indicators.sql) | Medium   | Completed | UNION ALL to flatten the table by shifting multiple years columns only one column and then using ROW_NUMBERS partitioned by country and indicator to get the ranks necessary for the solution. |
| [2022 vs 2023 vs 2024 Sales](https://github.com/sachin-2708/sqlPractice/blob/main/medium-77-2022-vs-2023-vs-2024-sales.sql) | Medium   | Completed | Using case when statements, the years wise data was brought into columns and then compared |
| [Hotel Booking Mistake](https://github.com/sachin-2708/sqlPractice/blob/main/medium-78-hotel-booking-mistake.sql) | Medium   | Completed | Flattening the tables by joining the Date Dimension table to the main table, and grouping the number of bookings for the customers for the same room, using Group_Concat to get the comma seperated list of affected customers  |
| [Child and Parents](https://github.com/sachin-2708/sqlPractice/blob/main/medium-82-child-and-parents.sql) | Medium   | Completed | Joined the same table two times with conditions to get mother and father assigned to child ID. Used SQL trick to aggregate child_id column to avoid NULL values on mother and father columns |
| [Netflix Device Type (PART-1)](https://github.com/sachin-2708/sqlPractice/blob/main/medium-88-netflix-device-type-(PART-1).sql) | Medium   | Completed | Used COUNT window function to get the device count and then did sum for aggregation. Alternative solution was to use Case When statement|
| [Netflix Device Type (PART-2)](https://github.com/sachin-2708/sqlPractice/blob/main/medium-89-netflix-device-type-(PART-2).sql) | Medium   | Completed | Grouped the counting by user_id and title to get the number of times the title was watched and then used case when to identify multiple device viewed and single device viewed cases  |
| [Election Winner](https://github.com/sachin-2708/sqlPractice/blob/main/medium-91-election-winner.sql) | Medium   | Completed | Various alternate solutions, important was two tables can also be joined using a comma in the Where Clause itself. Cross join can also be used if only one row table is to be joined to another table |
| [OTT Viewership](https://github.com/sachin-2708/sqlPractice/blob/main/medium-93-ott-viewership.sql) | Medium   | Completed | Sum the duration and Rank the top two shows in each genre. Practiced CTEs |
| [Busiest Airline Route](https://github.com/sachin-2708/sqlPractice/blob/main/medium-96-busiest-airline-route.sql) | Medium   | Completed | Used Case When to update values for Return flight tickets. Alternatively, origin and destination columns can be interchanged when it is a return flight and then the busiest route can be found. |
| [Credit Card Transactions (Part-2)](https://github.com/sachin-2708/sqlPractice/blob/main/medium-98-credit-card-transactions-(Part-2).sql) | Medium   | Completed | Ranked using Window Function the highest and lowest amount credit cards, then using this in CTE, used Max to aggregate the data where we get 0 or null in the case when statements to collapse the entire columns into group of cities |
| [Loyal Customers](https://github.com/sachin-2708/sqlPractice/blob/main/medium-100-loyal-customers.sql) | Medium   | Completed | Count Distinct products in orders table should be equal to count of products in products table to identify the customers who purchased all products and then putting them in Having statement |
| [Users With Valid Passwords](https://github.com/sachin-2708/sqlPractice/blob/main/medium-102-users-with-valid-passwords.sql) | Medium   | Completed | Learnt a new function REGEXP_LIKE and [] array to identify the characters in that array; REGEXP can also be used here |
| [Student Major Subject](https://github.com/sachin-2708/sqlPractice/blob/main/medium-105-student-major-subject.sql) | Medium   | Completed | Used a subquery to identify students with 1 subject and used it in where clause with OR to get them with students with more than 1 subject; Can also use alternate solution to rank the cases based on flags Y or N using the Case When statement by assigning flag values 1 and 0 |
| [boAt Lifestyle Marketing](https://github.com/sachin-2708/sqlPractice/blob/main/medium-2-boAt-lifestyle-marketing.sql) | Medium   | Completed | Created multiple CTEs based on the required conditions and then joined them; used two alternate solutions |
| [Products Sold in All Cities](https://github.com/sachin-2708/sqlPractice/blob/main/medium-108-products-sold-in-all-cities.sql) | Medium   | Completed | Find the product and city combination and then compare it to the number of cities in the city table. |
| [Top 5 Single-Purchase Spendings](https://github.com/sachin-2708/sqlPractice/blob/main/medium-109-top-5-single-purchase-spendings.sql) | Medium   | Completed | Simple solution using Max aggregation at customer level and then limiting it to top 5 rows; Alternately Rank window function was also used to identify purchases at customer level and ordering it at the main level. |
| [Reel Daily View Averages by State](https://github.com/sachin-2708/sqlPractice/blob/main/medium-112-reel-daily-view-averages-by-state.sql) | Medium   | Completed | Used Max to find the highest cumulative views and then divided it by the no of days to find the avg daily views  |
| [Goals Scored in Each Game](https://github.com/sachin-2708/sqlPractice/blob/main/medium-116-goals-scored-in-each-game.sql) | Medium   | Completed | Joined the games and goals table and then used it in CTE; from this CTE, used Case When statement to sum the teams 1 and 2 goals scored.  |
| [COVID Risk by Age](https://github.com/sachin-2708/sqlPractice/blob/main/medium-119-COVID-risk-by-age.sql) | Medium   | Completed | Created age groups using the Case When statement, and then summed the cases based on severity criteria  |
| [Recurring Monthly Customers](https://github.com/sachin-2708/sqlPractice/blob/main/medium-120-recurring-monthly-customers.sql) | Medium   | Completed | Used Count and Count Distinct in the Having clause to filter data and get the correct solution |
| [Third Highest Salary](https://github.com/sachin-2708/sqlPractice/blob/main/medium-122-third-highest-salary.sql) | Medium   | Completed | Used Rank function in the CTE to get the 3rd ranking salary dept wise and then left joined cte to the main table and on condition having rank = 3; alternative solution - Using Case when rnk = 3 else null, we aggregate the data at departments using max and get the solution. |
| [Top 3 Netflix Shows](https://github.com/sachin-2708/sqlPractice/blob/main/medium-124-top-3-netflix-shows.sql) | Medium   | Completed | Using Sum and Count Distinct for watch time and unique users, used rank function in CTE to identify top 3 users |
| [Employees Status Change(Part-1)](https://github.com/sachin-2708/sqlPractice/blob/main/medium-130-employees-status-change(Part-1).sql) | Medium   | Completed | Left Joininig both tables to each other 2 times by interchanging each other, we get details for new hire as well as resigned cases by using Union and then using it in CTE to fine solution based on the conditions. |
| [Employees Status Change(Part-2)](https://github.com/sachin-2708/sqlPractice/blob/main/medium-131-employees-status-change(Part-2).sql) | Medium   | Completed | Similar to part1 with only one table, Used LEAD, LAG, and CTEs to identify employee promotion, resignation, and new hires based on year-wise designation changes. |
| [Projects Source System](https://github.com/sachin-2708/sqlPractice/blob/main/medium-133-projects-source-system.sql) | Medium   | Completed | Used Case When statement in the Order By of Window Function to rank the data based on the conditions and used it in CTE to get the rn = 1 results |
| [Music Lovers](https://github.com/sachin-2708/sqlPractice/blob/main/medium-135-music-lovers.sql) | Medium   | Completed | Using Distinct Count to count the distinct number of days for login and then comparing it with the difference in days between user's first login and current date using CURDATE() to identify daily logins |
| [Myntra Campaign Effectiveness](https://github.com/sachin-2708/sqlPractice/blob/main/medium-137-myntra-campaign-effectiveness.sql) | Medium   | Completed | Used logic to find the last month and 3rd month from current date to identify customers in the previous 3 months excluding current month; Alternate solution is to use Date_sub and Date_format to compare dates with start of current month using curdate(), %Y-%m-01 |
| [Customer Data Cleaning](https://github.com/sachin-2708/sqlPractice/blob/main/medium-138-customer-data-cleaning.sql) | Medium   | Completed | Trim, lower, coalesce and regex_replace(phone,[^0-9],'') used to clean the data and row number used to identify the duplicate entries  |
| [Frequent Flyers](https://github.com/sachin-2708/sqlPractice/blob/main/medium-141-frequent-flyers.sql) | Medium   | Completed | Used inner join to join two tables and used date_sub and curdate() to put 1 year condition and then counted th combination of passenger id and airport and filter 5 or more flights from same airport using having   |
| [SQL Champions](https://github.com/sachin-2708/sqlPractice/blob/main/medium-147-SQL-champions.sql) | Medium   | Completed | Used Subquery to identify users who don't have SQL skills and then main query identified students not in sub query; alternately, count window function can be used to identify only one skill that is SQL. |
| [Individual Contributors](https://github.com/sachin-2708/sqlPractice/blob/main/medium-148-individual-contributors.sql) | Medium   | Completed | Found the unique manager ids and then compared it with employee ids to identify employees who are not managers yet; Alternatively, we can use left join distinct manager ID to main table and then identify the null values |
| [Employees Not Promoted](https://github.com/sachin-2708/sqlPractice/blob/main/medium-149-employees-not-promoted.sql) | Medium   | Completed | Identify the max promotion date for all the employees and then filter it further by putting the condition that max promotion date is before 1 year from today; alternate solution is to identify the emp promoted in last year and joining them to employee table and then again joining them to employee table |
| [Active Viewers by Day](https://github.com/sachin-2708/sqlPractice/blob/main/medium-152-active-viewers-by-day.sql) | Medium   | Completed | Join the two tables and then for viewer_id and view_date combination count distinct authors and articles |
| [Grand Slam Titles](https://github.com/sachin-2708/sqlPractice/blob/main/medium-153-grand-slam-titles.sql) | Medium   | Completed | Flatten the championships table using union all and then join it with players and then aggregate it using count |
| [Top 2 Scores per Student](https://github.com/sachin-2708/sqlPractice/blob/main/medium-155-top-2-scores-per-student.sql) | Medium   | Completed | Using Dense Rank, order the data for students and then sum the top 2 marks for each students |
| [Sequence Expansion](https://github.com/sachin-2708/sqlPractice/blob/main/medium-115-sequence-expansion.sql) | Medium   | Completed | Practised Recursive CTE |
| [New and Repeat Customers](https://github.com/sachin-2708/sqlPractice/blob/main/hard-9-new-and-repeat-customers-Q3.sql) | Hard   | Completed | Identifying the 1st order of customers in cte and then joining it to the main table to compare first order and repeat order in case when statements |
| [The Little Master](https://github.com/sachin-2708/sqlPractice/blob/main/hard-10-the-little-master.sql) | Hard   | Completed | Using Sum window function without partition, only order by match no to get the running sum of runs scored, identify match no using case when runnning score is > 500 and then limiting it to 1st filtered match. And sum of run scored divided by the count of matches where status is out using case when, we calculate the batting average.  |
| [Workaholics Employees](https://github.com/sachin-2708/sqlPractice/blob/main/hard-14-workaholics-employees.sql) | Hard   | Completed | Found hours by timestampdiff(second, login, logout)/3600, then using case when statements created conditions and through CTEs got to the solution. |
| [Lift Overloaded (Part 1)](https://github.com/sachin-2708/sqlPractice/blob/main/hard-15-lift-overloaded-(part-1).sql) | Hard   | Completed | Using SUM windows function, find the rolling sum of the weights of the passengers in the lift in the increasing order of their weight and then compare rolling sum with the lift capacity to find the eligible passengers and then user group_concat. |
| [Lift Overloaded (Part 2)](https://github.com/sachin-2708/sqlPractice/blob/main/hard-16-lift-overloaded-(part-2).sql) | Hard   | Completed | Using SUM windows function, find the rolling sum of the weights of the passengers in the lift first by their gender using case when to identify and order females first and then increasing order of their weight and then compare rolling sum with the lift capacity to find the eligible passengers and then user group_concat. |
| [User Session Activity](https://github.com/sachin-2708/sqlPractice/blob/main/hard-118-user-session-activity.sql) | Hard   | Completed | Identify the end time using Lag function from previous row and difference between them. After that using case when statement flag cases within 30 mins of the time frame and using running sum to assign a group id to them. Using these two as CTEs, session number is decided using row_number function and group by using  user id and group id. |
| [Project Budget](https://github.com/sachin-2708/sqlPractice/blob/main/hard-125-project-budget.sql) | Hard   | Completed | Join three tables then sum the product of salary and the project duration in days using datediff and divide by 365 days to get project cost and then using case when statement get the solution |
| [Trending Products](https://github.com/sachin-2708/sqlPractice/blob/main/hard-20-trending-products.sql) | Hard   | Completed | To get the sum of previous 2 month we can bring them next to each other using lag windows functions 2 times and then do the additions in the main query. Alternatively, we can also use the sum windows function with range rows 2 preceding and rows 1 preceding and then find the solution. |
| [Uber Profit Rides](https://github.com/sachin-2708/sqlPractice/blob/main/hard-21-uber-profit-rides.sql) | Hard   | Completed | Using lag function, identified the previous end time and prev destination and brought it in a column, compared start time and start loc with prev_end_time and loc in case when statement to sum them and identify the profit rides. Alternatively, also joined the drivers table two times comparing the start_time of first table to end_time of second table. And then aggregating the required conditions |
| [The United States of America](https://github.com/sachin-2708/sqlPractice/blob/main/hard-22-the-united-states-of-america.sql) | Hard   | Completed | First aggregated the counts for all the records using country and satisfaction rating, then in CTE summed the counts and ranked them according to the highest count to identify the most frequent country name used for that job_satisfaction |
| [Product Recommendation](https://github.com/sachin-2708/sqlPractice/blob/main/hard-23-product-recommendation.sql) | Hard   | Completed | Using Self Join to bring the product pairs together. Using filter product_id in first table > product_id in second table to avoid pair duplication like p1-p1 or between p1-p2 and p2-p1 and then counting the instances. |
| [Points Table](https://github.com/sachin-2708/sqlPractice/blob/main/hard-42-points-table.sql) | Hard   | Completed | Using Union All bring the matches under rows by interchanging team_1 as team and team_2 as opponent and vice_versa. After that, use Case when to give Win and Draw flags. Once that is done, do the required calculations. |
| [Employees Inside Office (Part 2)](https://github.com/sachin-2708/sqlPractice/blob/main/hard-47-employees-inside-office(Part-2).sql) | Hard   | Completed | Used LEAD() to get each employee's next action time. Adjusted entry and exit times to fit within office hours using CASE, summed up time spent in minutes using TIMESTAMPDIFF, skipping negative durations. |
| [Credit Card Transactions (Part-1)](https://github.com/sachin-2708/sqlPractice/blob/main/hard-49-credit-card-transactions(Part-1).sql) | Hard   | Completed | Calculate each city's first transaction date and running total of amount using SUM() window function. Find the earliest date when total crosses 1500 for each city using a CASE + MIN(). And then returns city, first transaction date, target date, and days taken to reach 1500 using DATEDIFF. |
| [**LinkedIn Recommendation](https://github.com/sachin-2708/sqlPractice/blob/main/hard-53-linkedIn-recommendation.sql) | Hard   | Completed | Joined follows with likes to find posts liked by followed users, removed posts already liked by the user, counted likes per post, and used ROW_NUMBER() to pick the most liked post per user. |
| [Dashboard Visits](https://github.com/sachin-2708/sqlPractice/blob/main/hard-57-dashboard-visits.sql) | Hard   | Completed | First identify sessions using the lag function to find time between two visits. Count them using case when statement and timestampdiff. Also count distinct date to find unique days on which the user visited the dashboard. |
| [Final Account Balance](https://github.com/sachin-2708/sqlPractice/blob/main/hard-58-final-account-balance.sql) | Hard   | Completed | Calculated monthly spend, credits, and net amount per month using CASE and GROUP BY. Then computed final balance by applying penalties based on monthly credit conditions and missing active months. |
| [Employee Name](https://github.com/sachin-2708/sqlPractice/blob/main/hard-70-employee-name.sql) | Hard   | Completed | Used instr function to identify the comma and space positions in the names and then using case when statements found the first, middle and last names using substring function |
| [Above Average Employees](https://github.com/sachin-2708/sqlPractice/blob/main/hard-74-above-average-employees.sql) | Hard   | Completed | In the CTE calculate total salary, avg salary for the job title using windows function and rank the employees according to total salary and in case of tie with the base pay condition and then find the solution in the main query. |
| [Rider Ride Time](https://github.com/sachin-2708/sqlPractice/blob/main/hard-75-rider-ride-time.sql) | Hard   | Completed | Identify orders that were delivered on same dates, and ones picked up before midnight and delivered after midnight. In order to fidn time on each day after and before minute, use date and timestampdiff two times, one with pickup date and second with delivery date to divide two days and then union all. Then use SUM to aggregate the ride minutes.|
| [Top Products of Top Category](https://github.com/sachin-2708/sqlPractice/blob/main/hard-79-top-products-of-top-category.sql) | Hard   | Completed | Identify the top selling category using CTE and RANK and then use that category in the where clause of the main query. |
